---
outline: deep
---

## Performance API

## Webpack 优化前端性能

### 代码分割

使用Webpack的代码分割功能，将应用程序拆分为多个包，以实现按需加载。这减少了初始加载时间，并减少了首次加载时需要下载的数据量。

### 压缩代码

使用Webpack的压缩插件来压缩Javascript代码，压缩代码可以减小文件大小，加速加载时间。

### Tree Shaking

通过Webpack的Tree Shaking功能，可以消除未使用的代码，以减小生成的包的大小。

### 图片优化

使用Webpack的图像加载器和插件，自动优化图像，包括压缩和格式转换，以减小图像文件的大小。

### 资源缓存

使用Webpack的文件名哈希和输出文件分离，以便在构建时生成带有哈希的文件名，从而有效地利用浏览器缓存。

### 分割CSS

将CSS文件和JavaScript文件分离，以减小首次加载时的文件大小，或者使用Webpack的MiniCssExtractPlugin。

### CDN加速

将静态资源（图片、文字、库等）托管到CDN上，以加速加载资源。

### CDN切分块

使用externals配置将常用的库（如React、Vue等）从包中排除，以便从CDN加载，减少包大小。

### 懒加载

使用Webpack的懒加载机制，延迟加载不必要的代码，以提高初始加载速度。

### 预加载

使用Webpack的预加载功能，提前加载可能在未来需要的资源，以提高用户体验。（轮播图、幻灯片等）

## 如何实现长缓存

长缓存（Long-term cache）是一种前端性能优化策略，它旨在使浏览器能够缓存应用程序的静态资源（如Javascript、Css、图像等）更长的时间，
以减少不必要的网络请求，加速页面加载速度，并减少宽带消耗。通过将资源文件的内容与它们的文件名关联，可以实现长缓存。通常，浏览器会根据资源文件的URL
来判断是否从缓存中获取资源，因此如果资源文件的URL不变，浏览器就会继续使用缓存的资源，自到URL变化。

**落地方案：**

1. 使用文件名哈希：Webpack可以生成包含哈希值的文件名，以确保每个文件在内容发生变化时具有不同的文件名。这样，当文件内容发生变化时，浏览器会重新下载。

```ts
output: {
	filename: 'bunble.[contenthash].js'; // 使用哈希值作为文件名
}
```

2. 输出文件分离：将应用程序的代码与第三方库、样式表和其他资源文件分开打包成多个文件。这样，只有在发生变化时才需要重新下载应用程序代码，而其他资源可以长期缓存。

```ts
optimization: {
    runtimeCheck:'single', // 将运行时代码单独打包
    splitChunks: {
        cacheGroups: {
            vendor: {
                test: /[\\/]node_modules[\\/]/,
                name: 'vendors',
                chunks: 'all'
            }
        }
    }
}
```

3. 配置缓存控制： 在服务器端配置HTTP响应头，以设置资源文件的缓存控制策略，包括`Cache-Control`和`Expires`等。这些头部指示浏览器缓存资源的时间。

4. 版本号控制： 将资源文件的版本号添加到URL中，以强制浏览器重新下载文件，如：

```html
<script src="/bunble.js?v=2"></script>
```
